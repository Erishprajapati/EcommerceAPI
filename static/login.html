<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light d-flex align-items-center justify-content-center vh-100">

    <div class="card p-4 shadow" style="width: 100%; max-width: 400px;">
        <h2 class="text-center mb-4">Login</h2>
        <div class="mb-3">
            <input type="email" id="login-email" class="form-control" placeholder="Email">
        </div>
        <div class="mb-3">
            <input type="password" id="login-password" class="form-control" placeholder="Password">
        </div>
        <button class="btn btn-primary w-100" onclick="loginUser()">Login</button>
        <p id="login-response" class="text-danger mt-3 text-center"></p>
    </div>

    <script>
        function loginUser() {
            const loginData = {
                email: document.getElementById("login-email").value,
                password: document.getElementById("login-password").value
            };

            fetch('/user/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(loginData)
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(err => { throw err; });
                }
                return response.json();
            })
            .then(data => {
                document.getElementById("login-response").innerText = "Login successful!";
                console.log("Token:", data.access_token);
                localStorage.setItem("token", data.access_token);
                localStorage.setItem('loggedIn', 'true');
                window.location.href = "/static/index.html";
            })
            .catch(error => {
                document.getElementById("login-response").innerText = `Error: ${error.detail || "Invalid credentials"}`;
            });
        }
    </script>
</body>
</html>
